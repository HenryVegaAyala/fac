function ListarProyectos(o){var e="#gvFiltro .items-area";precargaExp("#gvFiltro",!0),$.ajax({type:"GET",url:"services/condominio/condominio-search.php",cache:!1,dataType:"json",data:"tipo=1&criterio="+$("#txtSearchFiltro").val()+"&pagina="+o,success:function(t){var a=0,r=0,i="";if(r=t.length,r>0){for(;a<r;)iditem=t[a].idproyecto,i+='<a href="#" class="list dato without-foto bg-gray-glass bg-cyan g200" data-idproyecto="'+iditem+'" data-tipoproyecto="'+t[a].tipoproyecto+'" data-nombre="'+t[a].nombreproyecto+'">',i+='<input name="chkItem[]" type="checkbox" class="oculto" value="'+iditem+'" />',i+='<div class="list-content pos-rel">',i+='<div class="data">',i+='<main><p class="fg-white"><span class="descripcion">'+t[a].nombreproyecto+"</span></p>",i+="</main></div></div>",i+="</a>",++a;paginaFiltro+=1,$("#hdPage").val(paginaFiltro),"1"==o?$(e).html(i):$(e).append(i)}else"1"==o&&$(e).html("<h2>No hay datos.</h2>");precargaExp("#gvFiltro",!1)}})}function ListarConcepto(o){var e="#gvFiltro",t=e+" .items-area";precargaExp(e,!0),$.ajax({url:"services/concepto/concepto-search.php",type:"GET",dataType:"json",data:{tipobusqueda:"3",id:"0",criterio:$("#txtSearchFiltro").val(),tipoconcepto:$("#ddlTipoConcepto").val(),pagina:o}}).done(function(a){var r=0,i=0,n="";if(i=a.length,i>0){for(;r<i;)iditem=a[r].tm_idconcepto,n+='<a href="#" class="list dato without-foto bg-gray-glass bg-cyan g200" data-idconcepto="'+iditem+'" data-formula="'+a[r].tm_definicion_formula+'" data-tipovalor="concepto">',n+='<input name="chkItem[]" type="checkbox" class="oculto" value="'+iditem+'" />',n+='<div class="list-content pos-rel">',n+='<div class="data">',n+='<main><p class="fg-white"><span class="codigo float-left">'+a[r].tm_idconcepto+' -&nbsp;</span><span class="descripcion float-left">'+a[r].tm_descripcionconcepto+"</span></p>",n+="</main></div></div>","1"==a[r].tm_esformula&&(n+='<span class="place-top-right bg-emerald margin10"><h5 class="fg-white padding10 no-margin text-center"><i class="icon-calculate"></i></h5></span>'),n+='<div class="place-bottom-left fg-white">',n+='<div class="tag-descrip bg-darkTeal">TIPO: '+a[r].nomtipoconcepto+"</div>",n+='<div class="tag-descrip bg-emerald">TIPO VALOR: '+a[r].nomtipovalor+"</div>",n+="</div>",n+="</a>",++r;paginaFiltro+=1,$("#hdPage").val(paginaFiltro),"1"==o?$(t).html(n):$(t).append(n)}else"1"==o&&$(t).html("<h2>No hay datos.</h2>");precargaExp(e,!1)}).fail(function(){console.log("error")}).always(function(){console.log("complete")})}function ListarPropiedades(o){var e="#gvFiltro .items-area";precargaExp("#gvFiltro",!0),$.ajax({type:"GET",url:"services/propiedad/propiedad-search.php",cache:!1,dataType:"json",data:{tipobusqueda:"1",id:$("#hdIdProyecto").val(),idtipopropiedad:$("#ddlTipoPropiedadFiltro").val(),criterio:$("#txtSearchFiltro").val(),pagina:o},success:function(t){var a=0,r=0,i="",n="",c="";if(r=t.length,r>0){for(;a<r;)iditem=t[a].idpropiedad,c=t[a].idtipopropiedad,"DPT"==c?n="bg-teal":"DEP"==c?n="bg-blueGrey":"EST"==c&&(n="bg-indigo"),i+='<div class="tile dato double bg-gray-glass '+n+'" ',i+='data-idpropiedad="'+iditem+'" ',i+='data-idtipopropiedad="'+c+'" ',i+='data-descripcion="'+t[a].descripcionpropiedad+'" ',i+='data-area="'+t[a].area+'">',i+='<input name="chkItem[]" type="checkbox" class="oculto" value="'+iditem+'" />',i+='<div class="tile_true_content">',i+='<div class="tile-content">',i+='<div class="text-right padding10 ntp">',i+='<h2 class="fg-white">'+t[a].descripcionpropiedad+"</h2>",i+="</div></div>",i+='<div class="brand"><span class="badge bg-dark">Area: '+t[a].area+" (m<sup>2</sup>)</span></div>",i+="</div>",i+="</div>",++a;paginaFiltro+=1,$("#hdPage").val(paginaFiltro),1==o?$(e).html(i):$(e).append(i)}else 1==o&&$(e).html("<h2>No se encontraron resultados.</h2>");precargaExp("#gvFiltro",!1)}})}function IntercambiarFiltros(){var o="",e="";o=$("#ddlTipoReporte").val(),e=$("#ddlTipoReporte option:selected").text(),document.getElementById("hdTipoReporte").value=e,"01"==o?($("#rowFechaSimple").addClass("oculto"),$("#rowConcepto, #lblTitleCustomFilter, #rowPropiedad, #rowPropietario, #rowFechaRango").removeClass("oculto")):("00"==o||"02"==o?($("#rowFechaSimple").addClass("oculto"),$("#rowFechaRango").removeClass("oculto")):"04"==o||"05"==o||"07"==o?$("#rowConcepto, #lblTitleCustomFilter, #rowFechaSimple, #rowFechaRango").addClass("oculto"):"08"==o||"09"==o||"10"==o?($("#rowConcepto, #lblTitleCustomFilter, #rowFechaRango").addClass("oculto"),$("#rowFechaSimple").removeClass("oculto")):($("#rowConcepto, #lblTitleCustomFilter").removeClass("oculto"),"06"==o?($("#rowFechaRango").removeClass("oculto"),$("#rowFechaSimple").addClass("oculto")):($("#rowFechaRango").addClass("oculto"),$("#rowFechaSimple").removeClass("oculto"))),$("#rowPropiedad, #rowPropietario").addClass("oculto"))}function VerImpresion(o){$("#pnlImpresionFactura").fadeIn(400,function(){$("#ifrImpresionFactura").attr("src",o)})}function RegistroPorDefecto(){$.ajax({url:"services/condominio/condominio-search.php",type:"GET",dataType:"json",data:{tipo:"defecto"},success:function(o){var e=0,t="0",a="";e=o.length,e>0&&(t=o[0].idproyecto,a=o[0].nombreproyecto,setProyecto(t,a))},error:function(o){console.log(o)}})}function setProyecto(o,e){$("#hdIdProyecto").val(o),$("#pnlInfoProyecto").attr("data-idproyecto",o),$("#pnlInfoProyecto .info .descripcion").text(e),$("#pnlDatosFiltro").fadeOut("400",function(){var o=new Date,e=o.getFullYear();ListarAnhoProceso(e)})}function ListarAnhoProceso(o){$.ajax({url:"services/proceso/proceso-search.php",type:"GET",dataType:"json",data:{tipobusqueda:"ANHO",idproyecto:$("#hdIdProyecto").val()},success:function(e){var t=0,a=0,r="",i="";if(a=e.length,a>0)for(;t<a;)i=o==e[t].per_ano?' selected="selected"':"",r+="<option"+i+' value="'+e[t].per_ano+'">'+e[t].per_ano+"</option>",++t;else r+='<option value="0">NO HAY PROCESOS RELACIONADOS CON EL PROYECTO SELECCIONADO</option>';$("#ddlAnho").html(r),$("#ddlAnhoIni").html(r),$("#ddlAnhoFin").html(r)},error:function(o){console.log(o)}})}function GenerarReporte(o){var e,t=new FormData;precargaExp("#form1",!0),e=$("#form1 :input").serializeArray(),t.append("btnGenerarReporte","btnGenerarReporte"),t.append("hdTipoFormato",o),$.each(e,function(o,e){t.append(e.name,e.value)}),$.ajax({url:"services/reporteria/reporteador-post.php",type:"POST",dataType:"json",data:t,cache:!1,contentType:!1,processData:!1,success:function(e){precargaExp("#form1",!1),MessageBox(e.titulomsje,"La operación se completó satisfactoriamente","[Aceptar]",function(){"PDF"==o?VerImpresion(e.contenidomsje):"EXCEL"==o&&(window.location=e.contenidomsje)})},error:function(o){precargaExp("#form1",!1),MessageBox("Error en el servidor",o.responseText,"[Aceptar]",function(){}),console.log(o)}})}function IniciarForm(){var o=window.top.idproyecto,e=window.top.anho,t=window.top.mes;$("#hdIdProyecto").val(o),$("#hdIdConsumoProyecto").val(o),$("#hdAnho").val(e),$("#hdMes").val(t),$("#pnlInfoProyecto").attr("data-idproyecto",o);var a=(new Date,$("#hdAnho").val());ListarAnhoProceso(a)}$(function(){IntercambiarFiltros(),$("#ddlProyecto").on("change",function(o){o.preventDefault();var e=new Date,t=e.getFullYear(),a=$(this).val();$("#hdIdProyecto").val(a),window.top.idproyecto=a,ListarAnhoProceso(t)}),$("#ddlProyecto").trigger("change"),$(".sidebar-menu").on("click","a",function(o){o.preventDefault();var e=this.getAttribute("href");$(".sidebar-menu li").removeClass("bg-dark active"),$(this).parent().addClass("bg-dark active"),$(".xpanel").addClass("hide"),$(e).removeClass("hide")}),$("#btnImprimirReporte").on("click",function(o){o.preventDefault()}),$("#btnGenerarReporte_PDF").on("click",function(o){o.preventDefault(),GenerarReporte("PDF")}),$("#btnGenerarReporte_EXCEL").on("click",function(o){o.preventDefault(),GenerarReporte("EXCEL")}),$("#pnlFiltros").on("click",".panel-info",function(o){o.preventDefault();var e;e=this,$("#pnlDatosFiltro").fadeIn(400,function(){var o="",t="";o=e.getAttribute("data-tipofiltro"),t=e.getAttribute("data-hint"),paginaFiltro=1,"proyecto"==o?ListarProyectos("1"):"concepto"==o?ListarConcepto("1"):"propiedad"==o&&ListarPropiedades("1"),this.setAttribute("data-tipofiltro",o),$("#txtTituloFiltro").text(t)})}),$("#btnHideFiltro").on("click",function(o){o.preventDefault(),$("#pnlDatosFiltro").fadeOut(400,function(){})}),$("#gvFiltro > .items-area").on("scroll",function(){var o=0,e="";$(this).scrollTop()+$(this).innerHeight()>=$(this)[0].scrollHeight&&(o=Number($("#hdPage").val()),e=$("#pnlDatosFiltro").attr("data-tipofiltro"),"proyecto"==e?ListarProyectos(o):"concepto"==e?ListarConcepto(o):"propiedad"==e&&ListarPropiedades(o))}),$("#gvFiltro").on("click",".dato",function(o){o.preventDefault();var e,t="0",a="",r="";e=document.getElementById("pnlDatosFiltro"),r=e.getAttribute("data-tipofiltro"),"proyecto"==r&&(t=this.getAttribute("data-idproyecto"),a=this.getAttribute("data-nombre"),setProyecto(t,a))}),$("#ddlTipoReporte").on("change",function(o){o.preventDefault(),IntercambiarFiltros()}),$("#btnHideImpresion").on("click",function(o){o.preventDefault(),$("#pnlImpresionFactura").fadeOut(400)})});var paginaFiltro=1,arrMeses=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"];