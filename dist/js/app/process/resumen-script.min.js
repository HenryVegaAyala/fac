function Resumen_Proyecto(){$.ajax({url:"services/condominio/condominio-search.php",type:"GET",dataType:"json",data:{tipo:"reporte-resumen",tipobusqueda:"1",id:$("#hdIdProyecto").val(),anho:$("#ddlAnho").val()},success:function(e){var o=0,t=0,r="";if(t=e.length,t>0)for(;o<t;)r+="<tr>",r+="<td>"+e[o].mes+"</td>",r+='<td class="text-right">'+Number(e[o].importe_facturado).toFixed(2)+"</td>",r+='<td class="text-right">'+Number(e[o].importe_cobrado).toFixed(2)+"</td>",r+='<td class="text-right">'+Number(e[o].saldo).toFixed(2)+"</td>",r+='<td class="text-right">'+Number(e[o].porcentaje_saldo).toFixed(2)+"</td>",r+="</tr>",++o;$("#tableDetalle tbody").html(r),$("#tableDetalle .ibody table").enableCellNavigation(),CalcularTotal()},error:function(e){console.log(e)}})}function Resumen_Propietario(){$.ajax({url:"services/propietario/propietario-search.php",type:"GET",dataType:"json",data:{tipo:"REPORTE",tipobusqueda:"1",idproyecto:$("#hdIdProyecto").val(),id:$("#hdIdPropietario").val(),anho:$("#ddlAnho").val(),mes:$("#ddlMes").val()},success:function(e){var o=0,t=0,r="";if(t=e.length,t>0)for(;o<t;)r+="<tr>",r+="<td>"+e[o].descripcionpropiedad+"</td>",r+='<td class="importe_facturado">'+Number(e[o].importe_facturado).toFixed(2)+"</td>",r+='<td class="importe_cobrado">'+Number(e[o].importe_cobrado).toFixed(2)+"</td>",r+='<td class="saldo">'+Number(e[o].saldo).toFixed(2)+"</td>",r+='<td class="porcentaje_saldo">'+Number(e[o].porcentaje_saldo).toFixed(2)+"</td>",r+="</tr>",++o;$("#tableDetalle tbody").html(r),$("#tableDetalle .ibody table").enableCellNavigation(),CalcularTotal()},error:function(e){console.log(e)}})}function MostrarResumen(){"61"==$("#hdIdPerfil").val()?Resumen_Proyecto():Resumen_Propietario()}function ListarAnhoProceso(e){$.ajax({url:"services/proceso/proceso-search.php",type:"GET",dataType:"json",data:{tipobusqueda:"ANHO",idproyecto:$("#hdIdProyecto").val()},success:function(o){var t=0,r=0,a="",n="";if(r=o.length,r>0)for(;t<r;)n=e==o[t].per_ano?' selected="selected"':"",a+="<option"+n+' value="'+o[t].per_ano+'">'+o[t].per_ano+"</option>",++t;else a+='<option value="0">NO HAY PROCESOS RELACIOANDOS CON EL PROYECTO SELECCIONADO</option>';$("#ddlAnho").html(a),MostrarResumen()},error:function(e){console.log(e)}})}function IniciarForm(){if("61"==$("#hdIdPerfil").val()){var e=getParameterByName("idproyecto");ProyectoByIdX(e)}}function setProyecto(e,o,t){$("#hdIdProyecto").val(e),$("#pnlInfo").attr("data-idproyecto",e),$("#imgFoto").attr("src",o),$("#pnlInfo .info .descripcion").text(t);var r=new Date,a=r.getFullYear();ListarAnhoProceso(a)}function ProyectoByIdX(e){$.ajax({url:"services/condominio/condominio-search.php",type:"GET",dataType:"json",data:{tipo:"defecto",tipobusqueda:e},success:function(e){var o=e.length;if(o>0){var t=e[0].idproyecto,r=e[0].nombreproyecto,a=e[0].logo;setProyecto(t,a,r)}},error:function(e){console.log(e)}})}function CalcularTotal(){var e=0,o=0,t=0,r=0,a=$("#tableDetalle .ibody table"),n=a[0],l=n.rows.length;if(l>0)for(;r<l;)e+=Number(n.rows[r].cells[1].innerHTML),o+=Number(n.rows[r].cells[2].innerHTML),t+=Number(n.rows[r].cells[3].innerHTML),++r;document.getElementById("lblTotalFacturado").innerText=e.toFixed(2),document.getElementById("lblTotalCobrado").innerText=o.toFixed(2),document.getElementById("lblTotalSaldo").innerText=t.toFixed(2)}$(function(){$("#btnConsultar").on("click",function(e){e.preventDefault(),MostrarResumen()}),$("#ddlProyecto").on("change",function(e){e.preventDefault();var o=new Date,t=o.getFullYear(),r=$(this).val();$("#hdIdProyecto").val(r),window.top.idproyecto=r,ListarAnhoProceso(t)}),$("#ddlProyecto").trigger("change"),$("#ddlAnho").on("click",function(e){e.preventDefault(),MostrarResumen()}),$("#ddlMes").on("click",function(e){e.preventDefault(),MostrarResumen()})});