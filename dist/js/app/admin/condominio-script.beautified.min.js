function createFrame(e,o){var a=o.getAttribute("href"),t=o.getAttribute("data-url");if(0==$(e+" .tab-pane.active iframe").length){precargaExp("body",!0);var r=document.getElementById(a.substr(1)),i=document.createElement("iframe");t=t+"&idproyecto="+$("#hdIdProyecto").val(),i.setAttribute("scrolling","no"),i.setAttribute("marginwidth","0"),i.setAttribute("marginheight","0"),i.setAttribute("width","100%"),i.setAttribute("height","100%"),i.setAttribute("frameborder","no"),i.setAttribute("src",t),i.onload=function(e){precargaExp("body",!1)},r.appendChild(i)}}function ListarAnhoProceso(){$.ajax({url:"services/proceso/proceso-search.php",type:"GET",dataType:"json",data:{tipobusqueda:"ANHO",idproyecto:"0"},success:function(e){var o=0,a="",t=e.length;if(t>0)for(;o<t;)a+='<option value="'+e[o].per_ano+'">'+e[o].per_ano+"</option>",++o;else a='<option value="0">NO HAY PROCESOS VIGENTES</option>';$("#ddlAnho").html(a)},error:function(e){console.log(e)}})}function ListarProyectos(e){var o="#gvDatos";precargaExp("#gvDatos",!0),$.ajax({type:"GET",url:"services/condominio/condominio-search.php",cache:!1,dataType:"json",data:"criterio="+$("#txtSearch").val()+"&pagina="+e,success:function(a){var t=0,r="",i=a.length;if(i>0){for(;t<i;){var n=a[t].idproyecto;r+="<div ",r+='data-id="'+n+'" ',r+='data-idproyecto="'+n+'" data-codigo="'+a[t].codigoproyecto+'" data-tipoproyecto="'+a[t].tipoproyecto+'" data-datosimpleduplex="'+a[t].datosimpleduplex+'" data-tipovaloracion="'+a[t].tipovaloracion+'" ',r+='class="result item pos-rel animate mdl-shadow--2dp margin10 full-size">',r+='<div class="col-md-4">',r+="<h4>ID Proyecto #"+n+"</h4>",r+='<p class="lugar"><strong>'+a[t].codigoproyecto+" - "+a[t].nombreproyecto+"</strong></p>",r+='<p class="lugar"><strong>Direcci&oacute;n: </strong>'+a[t].direccionproyecto.length==0?"Sin direcci&oacute;n espec&iacute;fica":a[t].direccionproyecto+"</p>",r+="</div>",r+='<div class="col-md-4">',r+="<h4>Tipo de proyecto:</h4>",r+='<span class="duracion">'+a[t].ubigeo+"</span>",r+="</div>",r+='<div class="col-md-4">',r+='<div class="grouped-buttons no-margin pos-rel">',r+='<a data-action="more" href="#" class="btn btn-primary right margin10">Opciones</a>',r+='<ul class="dropdown">',r+='<li><a href="#" data-action="edit">Editar</a></li>',r+='<li><a href="#" data-action="more-info">M&aacute;s informaci&oacute;n</a></li>',r+='<li role="separator" class="divider"></li>',r+='<li><a href="#" data-action="delete">Eliminar</a></li>',r+="</ul>",r+="</div>",r+='<div class="clear"></div>',r+="</div>",r+="</div>",++t}paginaProyecto+=1,$("#hdPageProyecto").val(paginaProyecto),"1"==e?$(o).html(r):$(o).append(r)}else"1"==e&&$(o).html("<h2>No hay datos.</h2>");precargaExp("#gvDatos",!1)}})}function ListarPropiedades(e){var o="#gvPropiedad .items-area";precargaExp("#gvPropiedad",!0),$.ajax({type:"GET",url:"services/propiedad/propiedad-search.php",cache:!1,dataType:"json",data:{tipobusqueda:"1",id:$("#hdIdProyecto").val(),idtipopropiedad:$("#ddlTipoPropiedadFiltro").val(),criterio:$("#txtSearchPropiedad").val(),pagina:e},success:function(a){var t=0,r=0,i="",n="",c="",d="",l="",s="",p="",u="",m="";$("#hdTipoValoracion").val();if(r=a.length,r>0){for(;t<r;)c=a[t].idpropiedad,d=a[t].idtipopropiedad,null!=a[t].numerodoc&&(s=0==a[t].numerodoc.trim().length?"":a[t].numerodoc+" "),p=null!=a[t].descrippersona?0==a[t].descrippersona.trim().length?"(EN BLANCO)":a[t].descrippersona:"(EN BLANCO)","DPT"==d?n="bg-white":"DEP"==d?n="bg-blueGrey":"EST"==d&&(n="bg-indigo"),l=Number(a[t].area)>0?"bg-dark":"bg-darkRed","0"==a[t].cantidadrelaciones?0==a[t].propiedadpadre.length?(u="SIN PROPIEDADES RELACIONADAS",m=" bg-gray"):(u=a[t].propiedadpadre,m=" bg-green"):(u="VER PROPIEDADES RELACIONADAS",m=" bg-green"),i+='<div class="tile dato double almost-double-vertical shadow '+n+'" ',i+='data-idpropiedad="'+c+'" ',i+='data-idtipopropiedad="'+d+'" ',i+='data-descripcion="'+a[t].descripcionpropiedad+'" ',i+='data-areasintechar="'+a[t].areasintechar+'" ',i+='data-areatechada="'+a[t].areatechada+'" ',i+='data-area="'+a[t].area+'" ',i+='data-idclasepropiedad="'+a[t].idclasepropiedad+'" ',i+='data-idpropietario="'+a[t].idpersona+'" ',i+='data-relaciones="'+a[t].cantidadrelaciones+'" ',i+='title="'+s+p+'">',i+='<input name="chkItem[]" type="checkbox" class="oculto" value="'+c+'" />',i+='<div class="place-top-left">',i+='<h5 class="fg-white">'+a[t].torre+"</h5>",i+="</div>",i+='<div class="inputInItem padding20 bg-white shadow row hide">',i+='<div class="grid fluid"><div class="row">',i+='<div class="span6">',i+='<div class="inputSaldoInicial">',i+="<label>Saldo Inicial</label>",i+='<div class="input-control text no-margin" data-role="input-control">',i+='<input type="text" class="input-saldoinicial" value="'+a[t].saldoinicial+'" />',i+='<button class="btn-clear" tabindex="-1" type="button"></button>',i+="</div>",i+="</div>",i+="</div>",i+='<div class="span6">',i+='<div class="inputRatio hide">',i+="<label>Ratio</label>",i+='<div class="input-control text no-margin" data-role="input-control">',i+='<input type="text" class="input-ratio" value="'+a[t].ratio+'" />',i+='<button class="btn-clear" tabindex="-1" type="button"></button>',i+="</div>",i+="</div>",i+='<div class="inputImporteFijo hide">',i+="<label>Importe Fijo</label>",i+='<div class="input-control text no-margin" data-role="input-control">',i+='<input type="text" class="input-importefijo" value="'+a[t].importefijo+'" />',i+='<button class="btn-clear" tabindex="-1" type="button"></button>',i+="</div>",i+="</div>",i+="</div>",i+="</div></div>",i+="</div>",i+='<div class="tile_true_content">',i+='<div class="tile-content">',i+='<div class="text-right padding10 ntp">',i+='<h2 class="fg-white">'+a[t].descripcionpropiedad+"</h2>",i+='<h6 class="padding5 text-ellipsis smaller bg-white text-center fg-dark">'+p+"</h6>",i+='<h6 class="link-relacion padding5 smaller bg-white text-center fg-white'+m+'">'+u+"</h6>",i+="</div>",i+="</div>",i+='<div class="brand"><span class="badge '+l+'">Area: '+a[t].area+" (m<sup>2</sup>)</span></div>",i+="</div>",i+="</div>",++t;paginaPropiedad+=1,$("#hdPagePropiedad").val(paginaPropiedad),1==e?$(o).html(i):$(o).append(i)}else 1==e&&$(o).html("<h2>No se encontraron resultados.</h2>");precargaExp("#gvPropiedad",!1)}})}function ListarPropietarios(e){var o="#gvPropietario .items-area";precargaExp("#gvPropietario",!0),$.ajax({type:"GET",url:"services/propietario/propietario-search.php",cache:!1,dataType:"json",data:"criterio="+$("#txtSearchPropietario").val()+"&pagina="+e,success:function(a){var t=0,r=a.length,i="";if(r>0){for(;t<r;)iditem=a[t].tm_idtipopropietario,foto=a[t].tm_foto,i+='<a href="#" class="list dato bg-gray-glass bg-cyan" data-idpropietario="'+iditem+'" data-tipopropietario="'+a[t].tm_iditc+'" data-tipopersona="00">',i+='<input name="chkItem[]" type="checkbox" class="oculto" value="'+iditem+'" />',i+='<div class="list-content pos-rel">',i+='<span class="ubigeotag fg-white bg-darkCyan place-top-right padding5 margin5">UBIGEO: '+a[t].ubigeo+"</span>",i+='<div class="data">',i+="<aside>",i+="no-set"==foto?'<i class="fa fa-user"></i>':'<img src="'+foto+'" />',i+="</aside>",i+='<main><p class="fg-white"><span class="descripcion">'+a[t].descripcion+'</span></p><p class="fg-white">Tel&eacute;fono: '+a[t].tm_telefono+' - Direcci&oacute;n: <span class="direccion">'+a[t].tm_direccion+'</span><br /><span class="docidentidad">'+a[t].tipodoc+": "+a[t].tm_numerodoc+"</span> - Email: "+a[t].tm_email+"</p>",i+="</main>",i+='<div class="progress-bar small" data-role="progress-bar" data-value="0"></div>',i+="</div></div>",i+="</a>",++t;paginaPropietario+=1,$("#hdPagePropietario").val(paginaPropietario),"1"==e?$(o).html(i):$(o).append(i)}else"1"==e&&$(o).html("<h2>No hay datos.</h2>");precargaExp("#gvPropietario",!1)}})}function ListarInquilinos(e){var o="#gvInquilino .items-area";precargaExp("#gvInquilino",!0),$.ajax({type:"GET",url:"services/inquilino/inquilino-search.php",cache:!1,dataType:"json",data:"criterio="+$("#txtSearchInquilino").val()+"&pagina="+e,success:function(a){var t=0,r=a.length,i="";if(r>0){for(;t<r;)iditem=a[t].tm_idtipoinquilino,foto=a[t].tm_foto,i+='<a href="#" class="list dato bg-gray-glass bg-cyan" data-idinquilino="'+iditem+'" data-tipoinquilino="'+a[t].tm_iditc+'" data-tipopersona="01">',i+='<input name="chkItem[]" type="checkbox" class="oculto" value="'+iditem+'" />',i+='<div class="list-content pos-rel">',i+='<span class="ubigeotag fg-white bg-darkCyan place-top-right padding5 margin5">UBIGEO: '+a[t].ubigeo+"</span>",i+='<div class="data">',i+="<aside>",i+="no-set"==foto?'<i class="fa fa-user"></i>':'<img src="'+foto+'" />',i+="</aside>",i+='<main><p class="fg-white"><span class="descripcion">'+a[t].descripcion+'</span></p><p class="fg-white">Tel&eacute;fono: '+a[t].tm_telefono+' - Direcci&oacute;n: <span class="direccion">'+a[t].tm_direccion+'</span><br /><span class="docidentidad">'+a[t].tipodoc+": "+a[t].tm_numerodoc+"</span> - Email: "+a[t].tm_email+"</p>",i+="</main>",i+='<div class="progress-bar small" data-role="progress-bar" data-value="0"></div>',i+="</div></div>",i+="</a>",++t;paginaInquilino+=1,$("#hdPageInquilino").val(paginaInquilino),"1"==e?$(o).html(i):$(o).append(i)}else"1"==e&&$(o).html("<h2>No hay datos.</h2>");precargaExp("#gvInquilino",!1)}})}function prepareImport(e){var o=["jpg","png","gif","jpeg"],a="",t="",r=new FileReader;return fileValue=e[0],t=e[0].name,a=t.split(".").pop().toLowerCase(),$.inArray(a,o)==-1?(MessageBox("Archivo no v&aacute;lido","El tipo de archivo *."+a+" no es compatible","[Aceptar]",function(){}),!1):(r.readAsDataURL(fileValue),console.log(fileValue),void(r.onload=function(e){$(".droping-air .help").text(t),$(".droping-air").addClass("dropped"),$(".droping-air > .icon").css("background","url("+e.target.result+") no-repeat center"),$(".droping-air > .cancel").removeClass("oculto")}))}function cancelImport(){$("#fileImagen").val(""),$(".droping-air .help").text("Seleccione o arrastre un archivo de imagen (*.jpg, .gif, *.png)"),$(".droping-air").removeClass("dropped"),$(".droping-air > .icon").css("background","transparent"),$(".droping-air > .cancel").addClass("oculto"),$("#hdFoto").val("no-set"),fileValue=!1}function CalcularArea(){var e=0,o=0,a=0;e=Number(document.getElementById("txtAreaTechada").value),o=Number(document.getElementById("txtAreaSinTechar").value),a=e+o,document.getElementById("txtAreaPropiedad").value=a.toFixed(2)}function AsignarPropiedades(){indexList=0,elemsSelected=$("#pnlPropietarioInquilino .list.selected").toArray(),EnvioDataAsignacion(elemsSelected[0])}function EnvioDataAsignacion(e){var o,a,t,r,i="",n="",c="",d=new FormData;t=$(e),o=t.find(".progress-bar"),a=o.progressbar({animate:!0,color:"bg-cyan"}),n=t.attr("data-tipopersona"),"00"==n?c=t.attr("data-idpropietario"):"01"==n&&(c=t.attr("data-idinquilino")),r=$("#gvPropiedad .tile.selected"),i=$.map(r,function(e,o){return e.getAttribute("data-idpropiedad")}).join(","),d.append("btnAsignarPropiedades","btnAsignarPropiedades"),d.append("listpropiedades",i),d.append("hdTipoPersona",n),d.append("hdIdPersona",c),$.ajax({url:"services/propiedad/propiedad-post.php",type:"POST",dataType:"json",data:d,cache:!1,contentType:!1,processData:!1,success:function(e){++indexList,progressError=!1,a.progressbar("value",100),a.progressbar("color","bg-green"),intervalProgress.isRunning()&&intervalProgress.stop(),indexList<=elemsSelected.length-1?EnvioDataAsignacion(elemsSelected[indexList]):(completado=!0,MessageBox(e.titulomsje,e.contenidomsje,"[Aceptar]",function(){"0"!=e.rpta&&(paginaPropiedad=1,ListarPropiedades("1"),$("#btnHidePropietarioInquilino").trigger("click"))}))},beforeSend:function(){completado=!1,intervalProgress.start()},complete:function(){progress=0,progressError&&0==completado&&setTimeout(function(){intervalProgress.isRunning()&&intervalProgress.stop(),a.progressbar("value",100),EnvioDataAsignacion(elemsSelected[indexList])},1e4)},error:function(e){progress=0,a.progressbar("color","bg-red"),progressError=!0,console.log(e)}})}function MostrarRowPorcentajeDuplex(e){e?$("#rowPorcentajeDuplex").show():($("#chkPorcjDuplex")[0].checked=!1,$("#rowPorcentajeDuplex").hide(),$("#rowPorcjDuplex").hide(),$("#rowChkPorcjDuplex").removeClass("span8").addClass("span12"),$("#txtPorcjDuplex").val("0"))}function MostrarPorcjDuplex(e){e?($("#rowPorcjDuplex").show(),$("#rowChkPorcjDuplex").removeClass("span12").addClass("span8"),$("#txtPorcjDuplex").val("50").focus()):($("#rowPorcjDuplex").hide(),$("#rowChkPorcjDuplex").removeClass("span8").addClass("span12"),$("#txtPorcjDuplex").val("0"))}function EliminarProyecto(){indexList=0,elemsSelected=$("#gvDatos .selected").toArray(),EliminarItemProyecto(elemsSelected[0])}function EliminarItemProyecto(e){var o=new FormData,a="0";a=e.getAttribute("data-idproyecto"),o.append("btnEliminarItem","btnEliminarItem"),o.append("hdIdProyecto",a),$.ajax({url:"services/condominio/condominio-post.php",type:"POST",dataType:"json",data:o,cache:!1,contentType:!1,processData:!1,success:function(o){var t,r,i=0,n="",c=0;r=$(e),c=r.height(),"0"==o.rpta?(n="El proyecto "+a+": "+r.find(".descripcion").text(),"ERROR-PROPIEDAD"==o.contenidomsje&&(n+=" tiene propiedades relacionadas."),MessageBox(o.titulomsje,n,"[Aceptar]",function(){})):(++indexList,t=$("#gvDatos .listview"),i=t.scrollTop(),r.fadeOut(400,function(){$(this).remove()}),indexList<=elemsSelected.length-1?(i+=c+18,t.animate({scrollTop:i},400,function(){EliminarItemProyecto(elemsSelected[indexList])})):MessageBox(o.titulomsje,o.contenidomsje,"[Aceptar]",function(){$("#btnLimpiarSeleccion").trigger("click")}))},error:function(e){console.log(e)}})}function GenerarFacturacion(){indexList=0,elemsSelected=$("#gvDatos .selected").toArray(),GenerarFacturacionProyecto(elemsSelected[0])}function GenerarFacturacionProyecto(e){var o=e.getAttribute("data-idproyecto"),a=$(e),t=a.find(".progress-bar"),r=t.progressbar({animate:!0,color:"bg-cyan"}),i=new FormData;i.append("btnGenerar","btnGenerar"),i.append("hdIdProyecto",o),i.append("ddlAnho",$("#ddlAnho").val()),i.append("ddlMes",$("#ddlMes").val()),i.append("txtFechaVencimiento",$("#txtFechaVencimiento").val()),i.append("txtFechaTope",$("#txtFechaTope").val()),$.ajax({url:"services/facturacion/facturacion-post.php",type:"POST",dataType:"json",data:i,cache:!1,contentType:!1,processData:!1,success:function(e){var o=$("#gvPropiedadSelected .listview"),t=o.scrollTop();++indexList,progressError=!1,r.progressbar("value",100),r.progressbar("color","bg-green"),intervalProgress.isRunning()&&intervalProgress.stop(),indexList<=elemsSelected.length-1?(t+=a.height()+18,o.animate({scrollTop:t},400,function(){GenerarFacturacionProyecto(elemsSelected[indexList])})):(completado=!0,MessageBox(e.titulomsje,e.contenidomsje,"[Aceptar]",function(){$("#btnLimpiarSeleccion").trigger("click"),paginaProyecto=1,ListarProyectos("1")}))},beforeSend:function(){closeCustomModal("#modalGenFacturacion"),$("#gvDatos .dato.selected .progress-bar").removeClass("hide"),intervalProgress.start()},complete:function(){progress=0,progressError&&0==completado&&setTimeout(function(){intervalProgress.isRunning()&&intervalProgress.stop(),r.progressbar("value",100),GenerarFacturacionProyecto(elemsSelected[indexList])},1e4)},error:function(e){progress=0,r.progressbar("color","bg-red"),progressError=!0,console.log(e)}})}function EliminarPropiedad(){indexList=0,elemsSelected=$("#gvPropiedad .selected").toArray(),EliminarItemPropiedad(elemsSelected[0])}function EliminarItemPropiedad(e){var o=new FormData,a="0";a=e.getAttribute("data-idpropiedad"),o.append("btnEliminarPropiedad","btnEliminarPropiedad"),o.append("hdIdPropiedad",a),$.ajax({url:"services/condominio/condominio-post.php",type:"POST",dataType:"json",data:o,cache:!1,contentType:!1,processData:!1,success:function(o){var t,r,i=0,n="",c=0;r=$(e),c=r.height(),"0"==o.rpta?(n="La propiedad "+a+": "+r.find(".descripcion").text(),"ERROR-PROPIEDAD"==o.contenidomsje&&(n+=" tiene propiedades relacionadas."),MessageBox(o.titulomsje,n,"[Aceptar]",function(){})):(++indexList,t=$("#gvPropiedad .listview"),i=t.scrollTop(),r.fadeOut(400,function(){$(this).remove()}),indexList<=elemsSelected.length-1?(i+=c+18,t.animate({scrollTop:i},400,function(){EliminarItemPropiedad(elemsSelected[indexList])})):MessageBox(o.titulomsje,o.contenidomsje,"[Aceptar]",function(){$("#btnClearSelPropiedades").trigger("click")}))},error:function(e){console.log(e)}})}function RomperRelaciones(){var e,o=new FormData;confirma=confirm("¿Desea romper las relaciones de las propiedades seleccionadas?"),confirma&&(e=$("#gvPropiedad input:checkbox:checked").serializeArray(),o.append("btnBreakRelacion","btnBreakRelacion"),$.each(e,function(e,a){o.append(a.name,a.value)}),$.ajax({url:"services/condominio/condominio-post.php",type:"POST",dataType:"json",data:o,cache:!1,contentType:!1,processData:!1,success:function(e){MessageBox(e.titulomsje,e.contenidomsje,"[Aceptar]",function(){$("#btnClearSelPropiedades").trigger("click"),paginaPropiedad=1,ListarPropiedades("1")})},error:function(e){console.log(e)}}))}function RelacionarDepartamento(){indexList=0,elemsSelected=$("#gvPropiedad .selected").toArray(),RelacionarItemDepartamento(elemsSelected[0])}function RelacionarItemDepartamento(e){var o=new FormData,a="0",t="0";a=$("#gvDepartamento .tile.selected").attr("data-idpropiedad"),t=e.getAttribute("data-idpropiedad"),o.append("btnRelacionar","btnRelacionar"),o.append("hdIdDepartamento",a),o.append("hdIdPropiedad",t),$.ajax({url:"services/condominio/condominio-post.php",type:"POST",dataType:"json",data:o,cache:!1,contentType:!1,processData:!1,success:function(o){var a,r="";a=$(e),"0"==o.rpta?(r="La propiedad "+t+": "+a.find(".descripcion").text(),"ERROR-PROPIEDAD"==o.contenidomsje&&(r+=" tiene departamentos relacionados."),MessageBox(o.titulomsje,r,"[Aceptar]",function(){})):(++indexList,indexList<=elemsSelected.length-1?RelacionarItemDepartamento(elemsSelected[indexList]):MessageBox(o.titulomsje,o.contenidomsje,"[Aceptar]",function(){$("#btnHideDepartamento").trigger("click"),paginaPropiedad=1,ListarPropiedades("1")}))},error:function(e){console.log(e)}})}function CopiarPropiedades(e,o,a,t){var r=0,i="",n="0",c="0",d="0",l="",s="",p=0;if(r=o,s=$("#ddlTipoPropiedad").val(),"NEW"==e?(c=s,p=parseInt(a.val())+1):"EDIT"==e&&(p=a.length),p>0)for(;r<p;)"NEW"==e?(l=s+r.toString(),d=$("#txtAreaPropiedad").val()):"EDIT"==e&&(n=a[r].getAttribute("data-idpropiedad"),c=a[r].getAttribute("data-idtipopropiedad"),d=a[r].getAttribute("data-area"),l=a[r].getAttribute("data-descripcion")),i+='<div href="#" class="list dato bg-gray-glass" data-idpropiedad="'+n+'" data-idtipopropiedad="'+c+'">',i+='<div class="list-content pos-rel">',i+='<span class="ubigeotag fg-white bg-darker place-top-right padding5 margin5">Area: '+d+" (m<sup>2</sup>)</span>",i+='<div class="data">',i+='<main style="max-width: 300px;">',i+='<div class="row">',i+='<div class="input-control text no-margin" data-role="input-control">',i+='<input type="text" class="input-descripcion" value="'+l+'" />',i+='<button class="btn-clear" tabindex="-1" type="button"></button>',i+="</div>",i+="</div>",i+='<div class="row">',i+="<label>Saldo Inicial</label>",i+='<div class="input-control text no-margin" data-role="input-control">',i+='<input type="text" class="input-saldoinicial" value="0" />',i+='<button class="btn-clear" tabindex="-1" type="button"></button>',i+="</div>",i+="</div>","02"==$("#hdTipoValoracion").val()?(i+='<div class="row">',i+="<label>Ratio</label>",i+='<div class="input-control text no-margin" data-role="input-control">',i+='<input type="text" class="input-ratio" value="0" />',i+='<button class="btn-clear" tabindex="-1" type="button"></button>',i+="</div>",i+="</div>"):"03"==$("#hdTipoValoracion").val()&&(i+='<div class="row">',i+="<label>Importe fijo</label>",i+='<div class="input-control text no-margin" data-role="input-control">',i+='<input type="text" class="input-importefijo" value="0" />',i+='<button class="btn-clear" tabindex="-1" type="button"></button>',i+="</div>",i+="</div>"),i+="</main>",i+='<div class="progress-bar small" data-role="progress-bar" data-value="0"></div>',i+="</div></div>",i+="</div>",++r;$("#gvPropiedadSelected .items-area").html(i),t()}function DetalleConcepto(e,o,a){this.codigoconcepto=e,this.valorconcepto=o,this.tiporesultado=a}function EditMassrPropiedad(){return 0==$("#txtAreaPropiedad").val().trim().length?(MessageBox("Valores no v&aacute;lidos","Area de propiedades deben tener algun valor","[Aceptar]",function(){}),!1):0==Number($("#txtAreaPropiedad").val())?(MessageBox("Valores no v&aacute;lidos","Area de propiedades deben ser mayores a cero","[Aceptar]",function(){}),!1):(indexList=0,elemsSelected=$("#gvPropiedadSelected .list").toArray(),void EnvioDataEditPropiedad(elemsSelected[0]))}function ExtraerDetalleConcepto(e){var o,a,t=0,r=0,i="",n="",c="",d=[],l="";if(c="00"==e?"#tableConcepto":"#tableConceptoFormula",o=$(c+" .ibody table"),a=o[0],r=a.rows.length,r>0){for(;t<r;){i=a.rows[t].getAttribute("data-idconcepto"),n="00"==e?a.rows[t].cells[1].childNodes[0].value:a.rows[t].cells[1].childNodes[0].innerText;var s=new DetalleConcepto(i,n,e);d.push(s),++t}l=JSON.stringify(d)}return l}function EnvioDataEditPropiedad(e){var o,a,t,r,i=new FormData,n="",c="0",d="",l="0",s="0";n=e.getAttribute("data-idpropiedad"),c=e.getAttribute("data-idtipopropiedad"),t=$(e),d=t.find(".input-descripcion").val();var p=t.find(".input-saldoinicial").val();"02"==$("#hdTipoValoracion").val()?l=t.find(".input-ratio").val():"03"==$("#hdTipoValoracion").val()&&(s=t.find(".input-importefijo").val()),o=t.find(".progress-bar"),a=o.progressbar({animate:!0,color:"bg-cyan"}),r=$("#modalGenPropiedad :input").serializeArray(),$.each(r,function(e,o){i.append(o.name,o.value)}),i.append("btnPropiedadMasiva","btnPropiedadMasiva"),i.append("hdIdProyecto",$("#hdIdProyecto").val()),i.append("hdIdPropiedad",n),i.append("ddlTipoPropiedad",c),i.append("txtNombrePropiedad",d),i.append("txtRatioPropiedad",l),i.append("txtImporteFijoPropiedad",s),i.append("txtSaldoInicial",p),i.append("chkIngresoTorre",1==$("#chkIngresoTorre")[0].checked?"1":"0"),i.append("hdIdTorre",$("#hdIdTorre").val()),i.append("txtIngresoTorre",$("#txtIngresoTorre").val()),i.append("txtNroSuministro",$("#txtNroSuministro").val()),i.append("txtAreaSinTechar",$("#txtAreaSinTechar").val()),i.append("txtAreaTechada",$("#txtAreaTechada").val()),i.append("txtAreaPropiedad",$("#txtAreaPropiedad").val()),$.ajax({url:"services/condominio/condominio-post.php",type:"POST",dataType:"json",data:i,cache:!1,contentType:!1,processData:!1,success:function(e){var o,r=0;o=$("#gvPropiedadSelected .listview"),r=o.scrollTop(),++indexList,progressError=!1,a.progressbar("value",100),a.progressbar("color","bg-green"),intervalProgress.isRunning()&&intervalProgress.stop(),indexList<=elemsSelected.length-1?(r+=t.height()+18,o.animate({scrollTop:r},400,function(){EnvioDataEditPropiedad(elemsSelected[indexList])})):(completado=!0,MessageBox(e.titulomsje,e.contenidomsje,"[Aceptar]",function(){"0"!=e.rpta&&(paginaPropiedad=1,closeCustomModal("#modalGenPropiedad"),ListarPropiedades("1"))}))},beforeSend:function(){intervalProgress.start()},complete:function(){progress=0,progressError&&0==completado&&setTimeout(function(){intervalProgress.isRunning()&&intervalProgress.stop(),a.progressbar("value",100),EnvioDataEditPropiedad(elemsSelected[indexList])},1e4)},error:function(e){progress=0,a.progressbar("color","bg-red"),progressError=!0,console.log(e)}})}function ListarTorres(){$.ajax({url:"services/torre/torre-search.php",type:"GET",dataType:"json",data:{tipobusqueda:"2",id:$("#hdIdProyecto").val()}}).done(function(e){var o=0,a=0,t="";if(a=e.length,a>0)for(;o<a;)t+='<div data-idtorre="'+e[o].idtorre+'" title="'+e[o].descripciontorre+'" class="panel-info without-foto">',t+='<div class="info">',t+='<h3 class="descripcion">'+e[o].descripciontorre+"</h3>",t+="</div>",t+="</div>",++o;else t="<h2>No hay datos.</h2>";$("#gvTorre").html(t)}).fail(function(){console.log("error")}).always(function(){console.log("complete")})}function EvalConcepto(){var tableConcepto,tableConceptoFormula,itemsConcepto,itemsFormula,codigoconcepto="",valor="",formula="",i=0,j=0,countdata_concepto=0,countdata_formula=0,nrodecimales_concepto=0,nrodecimales_formula=0,nrocaracteres_formula="",resultformula;if(itemsConcepto=$("#tableConcepto .ibody table"),tableConcepto=itemsConcepto[0],itemsFormula=$("#tableConceptoFormula .ibody table"),tableConceptoFormula=itemsFormula[0],countdata_concepto=tableConcepto.rows.length,countdata_formula=tableConceptoFormula.rows.length,countdata_formula>0)for(;i<countdata_formula;){if(formula=tableConceptoFormula.rows[i].getAttribute("data-formula"),j=0,nrocaracteres_formula=Number(tableConceptoFormula.rows[i].getAttribute("data-nrocaracteres")),nrodecimales_formula=Number(tableConceptoFormula.rows[i].getAttribute("data-nrodecimales")),countdata_concepto>0)for(;j<countdata_concepto;)codigoconcepto=tableConcepto.rows[j].getAttribute("data-idconcepto"),valor=tableConcepto.rows[j].cells[1].childNodes[0].value,nrodecimales_concepto=Number(tableConcepto.rows[j].getAttribute("data-nrodecimales")),"01"==tableConcepto.rows[j].getAttribute("data-tipovalor")&&(valor=nrodecimales_concepto>0?"Number("+Number(valor).toFixed(nrodecimales_concepto)+")":"Number("+valor+")"),formula=formula.replace("["+codigoconcepto+"]",valor),++j;try{resultformula=eval(formula)}catch(err){console.log(err.message)}"01"==tableConceptoFormula.rows[i].getAttribute("data-tipovalor")?nrodecimales_formula>0&&(resultformula=Number(resultformula).toFixed(nrodecimales_formula)):resultformula=resultformula.toString().substring(0,nrocaracteres_formula),tableConceptoFormula.rows[i].cells[1].childNodes[0].innerText=resultformula,++i}}function ListarConceptos(e,o,a,t){precargaExp("#modalConcepto .modal-example-body",!0),$.ajax({url:"services/concepto/concepto-search.php",type:"GET",dataType:"json",data:{tipo:e,tipoconcepto:o,subtipoconcepto:a,idproyecto:$("#hdIdProyecto").val(),idpropiedad:t}}).done(function(e){var o=0,a=0,t="",r="",i="",n="",c=0,d=0,l="";if(a=e.length,precargaExp("#modalConcepto .modal-example-body",!1),a>0)for(;o<a;)strhtml="<tr ",strhtml+='data-idconcepto="'+e[o].tm_idconcepto+'" ',strhtml+='data-esformula="'+e[o].tm_esformula+'" ',strhtml+='data-formula="'+e[o].tm_definicion_formula+'" ',strhtml+='data-tipovalor="'+e[o].ta_tipovalor+'" ',strhtml+='data-nrocaracteres="'+e[o].tm_numerocaracteres+'" ',strhtml+='data-nrodecimales="'+e[o].tm_numerodecimales+'">',strhtml+='<td class="colConcepto">',strhtml+="<h4>"+e[o].tm_idconcepto+" - "+e[o].tm_descripcionconcepto+"</h4>",strhtml+="</td>",strhtml+='<td class="colValor">',c=Number(e[o].tm_numerodecimales),d=Number(e[o].td_valorconcepto),"00"==e[o].ta_tipovalor?(i="",n=' maxlength="'+e[o].tm_numerocaracteres+'"'):(i="0",n="",c>0&&(i+="."+"0".repeat(c))),l=d>0?d:i,"0"==e[o].tm_esformula?strhtml+='<input type="text" name="txtValorConcepto[]" class="inputTextInTable" value="'+l+'"'+n+" />":strhtml+="<h4>"+l+"</h4>",strhtml+="</td>",strhtml+="</tr>","0"==e[o].tm_esformula?t+=strhtml:r+=strhtml,++o;$("#tableConcepto tbody").html(t),$("#tableConceptoFormula tbody").html(r),EvalConcepto()}).fail(function(e){console.log(e)}).always(function(){console.log("complete")})}function GoToPropiedades(e){var o=$(e),a=(o.attr("data-idproyecto"),o.find(".list-content .descripcion").text()),t=o.attr("data-tipoproyecto"),r=o.attr("data-tipovaloracion"),i=o.attr("data-datosimpleduplex");$("#hdTipoValoracion").val(r),$("#tituloProyecto").attr("data-hint",a).text(a),$("#chkIngresoTorre")[0].checked=!1,$("#rowIngreso").addClass("oculto"),"00"==t?($("#rowChkIngreso").removeClass("oculto"),$("#pnlInfoTorre").removeClass("oculto")):($("#rowChkIngreso").addClass("oculto"),$("#pnlInfoTorre").addClass("oculto")),"1"==i?($("#rowClasePropiedad").removeClass("oculto"),$("#ddlClasePropiedad")[0].selectedIndex=0):($("#rowClasePropiedad").addClass("oculto"),$("#ddlClasePropiedad").val("02")),paginaPropiedad=1,$("#pnlListado").fadeOut(400,function(){$("#pnlListPropiedades").fadeIn(400,function(){ListarPropiedades("1")})})}function GetLastIndexPropiedad(){$.ajax({url:"services/propiedad/propiedad-lastindex.php",type:"GET",dataType:"json",data:{idtipopropiedad:$("#ddlTipoPropiedad").val(),idproyecto:$("#hdIdProyecto").val()}}).done(function(e){$("#txtNroInicial").val(e)}).fail(function(){console.log("error")}).always(function(){console.log("complete")})}function GuardarDatos(){$("#form1").submit()}function MostrarModalPorTab(){var e="";e=$("#tabDetalle .tabs li.active").attr("data-tab"),"Torre"==e?openCustomModal("#modalTorre"):"Departamento"==e?openCustomModal("#modalDepartamento"):"Estacionamiento"==e?openCustomModal("#modalEstacionamiento"):"Deposito"==e?openCustomModal("#modalDeposito"):"AreaComun"==e&&openCustomModal("#modalAreaComun")}function setConstructora(e,o){$("#hdIdConstructora").val(e),$("#pnlInfoConstructora").attr("data-idconstructora",e),$("#pnlInfoConstructora .info .descripcion").text(o),$("#pnlConstructora").fadeOut("400",function(){})}function setUbigeo(e,o){$("#pnlInfoUbigeo").attr("data-idubigeo",e),$("#pnlInfoUbigeo .info .descripcion").text(o),$("#hdIdLocalidad").val(e),closeCustomModal("#modalUbigeo")}function setTorre(e,o){$("#pnlInfoTorre").attr("data-idtorre",e),$("#pnlInfoTorre .info .descripcion").text(o),$("#hdIdTorre").val(e),closeCustomModal("#modalTorre")}function setArea(){var e="",o=$("#tableConceptoFormula tbody tr:last-child .colValor h4");e=Number(o.text()).toFixed(2),$("#txtAreaPropiedad").val(e),$("#pnlInfoArea").attr("data-editado","1"),$("#pnlInfoArea .info .descripcion").html("Area: "+e+" (m<sup>2</sup>)")}function unsetArea(){$("#txtAreaPropiedad").val("0.00"),$("#pnlInfoArea").attr("data-editado","0"),$("#pnlInfoArea .info .descripcion").html("Area: 0 (m<sup>2</sup>)")}function ListarConstructora(){$.ajax({url:"services/constructora/constructora-search.php",type:"GET",dataType:"json",data:{tipo:"BUSQUEDA",tipobusqueda:"1",criterio:""}}).done(function(e){var o=0,a=0,t="";if(a=e.length,a>0){for(;o<a;)t+='<div class="tile dato double bg-olive" data-idconstructora="'+e[o].idconstructora+'" data-nombre="'+e[o].nombreconstructora+'">',t+='<input name="chkItem[]" type="checkbox" class="oculto" value="'+e[o].idconstructora+'" />',t+='<div class="tile_true_content">',t+='<div class="tile-content">',t+='<h3 class="text-center fg-white">'+e[o].nombreconstructora+"</h3>",t+="</div>",t+="</div>",t+="</div>",++o;$("#gvConstructora .items-area").html(t)}else $("#gvConstructora .items-area").html("<h2>No se encontraron resultados</h2>")}).fail(function(){console.log("error")}).always(function(){console.log("complete")})}function ListarUbigeo(){precargaExp("#modalUbigeo .scrollbarra",!0),$.ajax({url:"services/ubigeo/ubigeo-autocomplete.php",type:"GET",dataType:"json",data:{tipobusqueda:"1",criterio:$("#txtSearchUbigeo").val()}}).done(function(e){var o=0,a=0,t="";if(o=e.length,o>0)for(;a<o;)t+='<div data-idubigeo="'+e[a].tm_idubigeo+'" title="'+e[a].ubigeo+'" class="panel-info without-foto">',t+='<div class="info">',t+='<h3 class="descripcion">'+e[a].ubigeo+"</h3>",t+="</div>",t+="</div>",++a;else t="<h2>No hay datos.</h2>";$("#gvUbigeo").html(t),precargaExp("#modalUbigeo .scrollbarra",!1)}).fail(function(){console.log("error")}).always(function(){console.log("complete")})}function GoToEdit(){precargaExp("#modalRegistroProyecto",!0);var e=$("#gvDatos .list.selected"),o="0";e.length>0?(o=e.attr("data-idproyecto"),$.ajax({url:"services/condominio/condominio-search.php",type:"GET",dataType:"json",data:{tipobusqueda:"2",id:o},success:function(e){var o=0,a="",t=!1,r=!1,i="";precargaExp("#modalRegistroProyecto",!1),o=e.length,o>0&&(a=e[0].tipoproyecto,t="1"==e[0].datosimpleduplex,r="1"==e[0].tieneporcjduplex,i=e[0].logo,$("#hdIdProyecto").val(e[0].idproyecto),$("#ddlTipoProyecto").val(a),$("#ddlTipoValoracion").val(e[0].tipovaloracion),$("#txtCodigoProyecto").val(e[0].codigoproyecto),
$("#txtNombreProyecto").val(e[0].nombreproyecto),$("#txtDireccion").val(e[0].direccionproyecto),$("#ddlBanco").val(e[0].idbanco),$("#txtDireccionPago").val(e[0].direccionpago),$("#txtEmailPago").val(e[0].emailpago),$("#chkCobroDiferenciado")[0].checked="1"==e[0].escobrodiferenciado,$("#chkDatoSimpleDuplex")[0].checked=t,$("#chkPorcjDuplex")[0].checked=r,ShowAskCobroTorre(),MostrarRowPorcentajeDuplex(t),MostrarPorcjDuplex(r),ListarCuentaBancaria(e[0].idcuentabancaria),"no-set"!=i&&($(".droping-air .help").text(i.substring(i.lastIndexOf("/")+1)),$(".droping-air").addClass("dropped"),$(".droping-air > .icon").css("background","url("+i+") no-repeat center"),$(".droping-air > .cancel").removeClass("oculto")),$("#hdFoto").val(i),setConstructora(e[0].idconstructora,e[0].constructora),setUbigeo(e[0].idlocalidad,e[0].ubigeo),$("#txtPorcjDuplex").val(Number(e[0].porcjduplex).toFixed(2)))},error:function(e){console.log(e)}})):precargaExp("#modalRegistroProyecto",!1),openModalCallBack("#modalRegistroProyecto",function(){ListarConceptos("PROYECTO","04","0","0")})}function ShowPanelConstructora(){$("#pnlConstructora").fadeIn(400,function(){ListarConstructora()})}function ListarDepartamentos(e){var o="#gvDepartamento .items-area";precargaExp("#gvDepartamento",!0),$.ajax({type:"GET",url:"services/propiedad/propiedad-search.php",cache:!1,dataType:"json",data:{tipobusqueda:"1",id:$("#hdIdProyecto").val(),idtipopropiedad:"DPT",criterio:$("#txtSearchDepartamento").val(),pagina:e},success:function(a){var t=0,r=0,i="",n="",c="",d="",l="",s="",p="",u="",m="";if(r=a.length,r>0){for(;t<r;)c=a[t].idpropiedad,d=a[t].idtipopropiedad,null!=a[t].numerodoc&&(s=0==a[t].numerodoc.trim().length?"":a[t].numerodoc+" "),p=null!=a[t].descrippersona?0==a[t].descrippersona.trim().length?"(EN BLANCO)":a[t].descrippersona:"(EN BLANCO)","DPT"==d?n="bg-teal":"DEP"==d?n="bg-blueGrey":"EST"==d&&(n="bg-indigo"),l=Number(a[t].area)>0?"bg-dark":"bg-darkRed","0"==a[t].cantidadrelaciones?(u="SIN PROPIEDADES RELACIONADAS",m=" bg-gray"):(u="VER PROPIEDADES RELACIONADAS",m=" bg-green"),i+='<div class="tile dato double almost-double-vertical bg-gray-glass '+n+'" ',i+='data-idpropiedad="'+c+'" ',i+='data-idtipopropiedad="'+d+'" ',i+='data-descripcion="'+a[t].descripcionpropiedad+'" ',i+='data-areasintechar="'+a[t].areasintechar+'" ',i+='data-areatechada="'+a[t].areatechada+'" ',i+='data-area="'+a[t].area+'" ',i+='data-idclasepropiedad="'+a[t].idclasepropiedad+'" ',i+='data-idpropietario="'+a[t].idpersona+'" ',i+='data-relaciones="'+a[t].cantidadrelaciones+'" ',i+='title="'+s+p+'">',i+='<input name="chkItem[]" type="checkbox" class="oculto" value="'+c+'" />',i+='<div class="tile_true_content">',i+='<div class="tile-content">',i+='<div class="text-right padding10 ntp">',i+='<h2 class="fg-white">'+a[t].descripcionpropiedad+"</h2>",i+='<h6 class="padding5 text-ellipsis smaller bg-white text-center fg-dark">'+p+"</h6>",i+='<h6 class="padding5 smaller bg-white text-center fg-white'+m+'">'+u+"</h6>",i+="</div>",i+="</div>",i+='<div class="brand"><span class="badge '+l+'">Area: '+a[t].area+" (m<sup>2</sup>)</span></div>",i+="</div>",i+="</div>",++t;paginaPropiedad+=1,$("#hdPagePropiedad").val(paginaPropiedad),1==e?$(o).html(i):$(o).append(i)}else 1==e&&$(o).html("<h2>No se encontraron resultados.</h2>");precargaExp("#gvDepartamento",!1)}})}function ListarRelacionadas(e,o){var a="#gvRelaciones .items-area";precargaExp("#gvRelaciones",!0),$.ajax({type:"GET",url:"services/propiedad/propiedad-search.php",cache:!1,dataType:"json",data:{tipobusqueda:"3",id:e,idtipopropiedad:"0",criterio:$("#txtSearchRelacionadas").val(),pagina:o},success:function(e){var t=0,r=0,i="",n="",c="",d="",l="",s="",p="";if(r=e.length,r>0){for(;t<r;)c=e[t].idpropiedad,d=e[t].idtipopropiedad,s=0==e[t].numerodoc.trim().length?"":e[t].numerodoc+" ",p=0==e[t].descrippersona.trim().length?"(EN BLANCO)":e[t].descrippersona,"DPT"==d?n="bg-teal":"DEP"==d?n="bg-blueGrey":"EST"==d&&(n="bg-indigo"),l=Number(e[t].area)>0?"bg-dark":"bg-darkRed",i+='<div class="tile dato double bg-gray-glass '+n+'" ',i+='data-idpropiedad="'+c+'" ',i+='data-idtipopropiedad="'+d+'" ',i+='data-descripcion="'+e[t].descripcionpropiedad+'" ',i+='data-areasintechar="'+e[t].areasintechar+'" ',i+='data-areatechada="'+e[t].areatechada+'" ',i+='data-area="'+e[t].area+'" ',i+='data-idclasepropiedad="'+e[t].idclasepropiedad+'" ',i+='data-idpropietario="'+e[t].idpersona+'" ',i+='title="'+s+p+'">',i+='<input name="chkItem[]" type="checkbox" class="oculto" value="'+c+'" />',i+='<div class="tile_true_content">',i+='<div class="tile-content">',i+='<div class="text-right padding10 ntp">',i+='<h2 class="fg-white">'+e[t].descripcionpropiedad+"</h2>",i+='<h6 class="padding5 text-ellipsis smaller bg-white text-center fg-dark">'+p+"</h6>",i+="</div>",i+="</div>",i+='<div class="brand"><span class="badge '+l+'">Area: '+e[t].area+" (m<sup>2</sup>)</span></div>",i+="</div>",i+="</div>",++t;paginaPropiedad+=1,$("#hdPagePropiedad").val(paginaPropiedad),1==o?$(a).html(i):$(a).append(i)}else 1==o&&$(a).html("<h2>No se encontraron resultados.</h2>");precargaExp("#gvRelaciones",!1)}})}function ShowPanelDepartamento(){$("#pnlDepartamento").fadeIn(400,function(){ListarDepartamentos("1")})}function ShowPanelRelacionadas(e){$("#pnlRelacionadas").fadeIn(400,function(){ListarRelacionadas(e,"1")})}function ShowPanelPropietarioInquilino(){paginaPropietario=1,paginaInquilino=1,$("#pnlPropietarioInquilino").fadeIn(400,function(){ListarPropietarios("1"),ListarInquilinos("1")})}function FijarProyecto(){var e="0";e=$("#gvDatos .dato.selected").attr("data-idproyecto"),$.ajax({url:"services/condominio/condominio-post.php",type:"POST",dataType:"json",data:{btnFijarProyecto:"btnFijarProyecto",hdIdProyecto:e},success:function(e){MessageBox(e.titulomsje,e.contenidomsje,"[Aceptar]",function(){"0"!=e.rpta&&(paginaProyecto=1,clearOnlyListSelection(),ListarProyectos("1"),$("#btnNuevo, #btnUploadExcel").removeClass("oculto"),$("#btnLimpiarSeleccion, #btnListPropiedades, #btnEditar, #btnFijarProyecto, #btnEliminar").addClass("oculto"))})},error:function(){hdIdProyecto}})}function EnvioAdminDatos(e){var o,a=new FormData;precargaExp("#modalRegistroProyecto",!0),o=$("#modalRegistroProyecto :input").serializeArray(),detalleConcepto=ExtraerDetalleConcepto("00"),a.append("btnGuardar","btnGuardar"),a.append("hdIdProyecto",$("#hdIdProyecto").val()),a.append("hdIdConstructora",$("#hdIdConstructora").val()),a.append("hdIdLocalidad",$("#hdIdLocalidad").val()),a.append("hdFoto",$("#hdFoto").val()),a.append("archivo",fileValue),$.each(o,function(e,o){a.append(o.name,o.value)}),a.append("detalleConcepto",detalleConcepto),$.ajax({type:"POST",url:"services/condominio/condominio-post.php",contentType:!1,processData:!1,cache:!1,dataType:"json",data:a,success:function(e){precargaExp("#modalRegistroProyecto",!1),MessageBox(e.titulomsje,e.contenidomsje,"[Aceptar]",function(){"0"!=e.rpta&&(paginaProyecto=1,clearOnlyListSelection(),ListarProyectos("1"),closeCustomModal("#modalRegistroProyecto"),$("#btnNuevo, #btnUploadExcel").removeClass("oculto"),$("#btnLimpiarSeleccion, #btnListPropiedades, #btnEditar, #btnFijarProyecto, #btnEliminar").addClass("oculto"))})},error:function(e){console.log(e)}})}function GoToEditPropiedad(){var e,o="0",a="0",t=0,r="0",i="0",n="0",c="";e=$("#gvPropiedad .selected"),t=e.length,t>1?$("#rowTipoPropiedad").hide():(o=e[0].getAttribute("data-idpropiedad"),a=e[0].getAttribute("data-idtipopropiedad"),r=e[0].getAttribute("data-areasintechar"),i=e[0].getAttribute("data-areatechada"),n=e[0].getAttribute("data-area"),c=e[0].getAttribute("data-idclasepropiedad"),$("#ddlTipoPropiedad").val(a),$("#txtAreaSinTechar").val(r),$("#txtAreaTechada").val(i),$("#txtAreaPropiedad").val(n),$("#ddlClasePropiedad").val(c),$("#rowTipoPropiedad").show()),$("#rowRangos").hide(),openModalCallBack("#modalGenPropiedad",function(){var e;e=$("#gvPropiedad .tile.selected"),CopiarPropiedades("EDIT",0,e,function(){})})}function GenerarVistaPreviaPropiedad(){var e,o=0;e=$("#txtNroFinal"),o=parseInt($("#txtNroInicial").val()),CopiarPropiedades("NEW",o,e,function(){})}function ShowAskCobroTorre(){"00"==$("#ddlTipoProyecto").val()?$("#rowCobroDiferenciado").show():($("#rowCobroDiferenciado").hide(),$("#chkCobroDiferenciado")[0].checked=!1)}function ListarCuentaBancaria(e){$.ajax({url:"services/cuentabancaria/cuentabancaria-search.php",type:"GET",dataType:"json",data:{tipobusqueda:"4",id:$("#ddlBanco").val()},success:function(o){var a=0,t=0,r="",i="";if(t=o.length,t>0)for(;a<t;)i=e==o[a].tm_idcuentabancaria?' selected="selected"':"",r+='<option value="'+o[a].tm_idcuentabancaria+'"'+i+">"+o[a].tm_descripcioncuenta+"</option>",++a;else r='<option value="0">No hay cuentas bancarias</option>';$("#ddlCuentaBancaria").html(r)},error:function(e){console.log(e)}})}function LimpiarProyecto(){$("#ddlTipoProyecto")[0].selectedIndex=0,$("#ddlTipoValoracion")[0].selectedIndex=0,$("#txtNombreProyecto").val(""),$("#txtCodigoProyecto").val(""),$("#txtDireccion").val(""),ShowAskCobroTorre(),$("#rowPorcentajeDuplex").hide()}function LimpiarForm(){$("#ddlTipoPropiedad")[0].selectedIndex=0,$("#txtAreaTechada").val("0.00"),$("#txtAreaSinTechar").val("0.00"),$("#txtAreaPropiedad").val("0.00"),$("#txtNroInicial").val("0"),$("#txtNroFinal").val("0"),$("#txtIngresoTorre").val(""),$("#txtNroSuministro").val("0"),$("#gvPropiedadSelected .items-area").html("")}function ListarProcesos(){var e=$("#hdIdProyecto").val();precargaExp("#tableProceso",!0),$.ajax({url:"services/proceso/proceso-search.php",type:"GET",dataType:"json",data:{tipobusqueda:"LISTADO",tipo:"1",id:e},success:function(e){var o,a=0,t=0,r="";if(precargaExp("#tableProceso",!1),t=e.length,t>0){for(;a<t;)r+='<tr data-idproceso="'+e[a].tm_idproceso+'" data-mes="'+e[a].tm_per_mes+'" data-anho="'+e[a].tm_per_ano+'" data-estado="'+e[a].tm_idestadoproceso+'">',r+="<td><h4>"+e[a].tm_per_ano+"</h4></td>",r+="<td><h4>"+arrMeses[parseInt(e[a].tm_per_mes)-1]+"</h4></td>",r+="<td></td>",r+='<td><button class="btn btn-primary center-block">Ver detalle</button></td>',r+="</tr>",++a;$("#tableProceso tbody").html(r).find('tr[data-estado="1"]:first').trigger("click"),o=$('#tableProceso tbody tr[data-estado="1"]').position(),$("#tableProceso .ibody-content").animate({scrollTop:o.top-50},400,function(){})}else $("#btnCerrarProceso").addClass("oculto"),$("#tableProceso tbody").html("")},error:function(e){console.log(e)}})}function GestionarProceso(e){var o,a,t,r=new FormData,i="0",n="0",c="0",d="0";precargaExp("#tableProceso",!0),t=$("#gvDatos .dato.selected"),d=t.attr("data-idproyecto"),o=$("#modalProceso :input").serializeArray(),e?(i=$("#ddlAnhoProceso").val(),n=$("#ddlMesProceso").val()):(a=$("#tableProceso tbody tr.selected"),c=a.attr("data-idproceso"),i=a.attr("data-anho"),n=a.attr("data-mes")),r.append("btnGuardar","btnGuardar"),r.append("hdIdProceso",c),r.append("hdIdProyecto",d),r.append("ddlAnho",i),r.append("ddlMes",n),$.ajax({url:"services/proceso/proceso-post.php",type:"POST",cache:!1,dataType:"json",contentType:!1,processData:!1,data:r,success:function(e){precargaExp("#tableProceso",!1),MessageBox(e.titulomsje,e.contenidomsje,"[Aceptar]",function(){"0"!=e.rpta&&ListarProcesos()})},error:function(e){console.log(e)}})}function DetallePropiedad(e,o,a){this.idpropiedad=e,this.saldoinicial=o,this.valor=a}function ActualizarValorFijoMasivo(){var e=new FormData,o=$("#hdTipoValoracion").val(),a=$("#txtValorFijo").val();precargaExp("#pnlListPropiedades",!0),o=$("#optSaldoInicial")[0].checked?"01":o,e.append("btnGuardarValores","btnGuardarValores"),e.append("hdIdProyecto",$("#hdIdProyecto").val()),e.append("hdTipoValoracion",o),e.append("txtValorFijo",a),$.ajax({url:"services/propiedad/propiedad-post.php",type:"POST",cache:!1,dataType:"json",contentType:!1,processData:!1,data:e,success:function(e){precargaExp("#pnlListPropiedades",!1),MessageBox(e.titulomsje,e.contenidomsje,"[Aceptar]",function(){"0"!=e.rpta&&(closeCustomModal("#modalGenValorFijo"),$("#btnClearSelPropiedades").trigger("click"),paginaPropiedad=1,ListarPropiedades("1"))})},error:function(e){console.log(e)}})}function ActualizarValorPropiedad(){var e=new FormData,o="",a=0,t=[],r=$("#hdTipoValoracion").val();precargaExp("#pnlListPropiedades",!0),$("#gvPropiedad .dato").each(function(e,o){var i=o.getAttribute("data-idpropiedad"),n=$(o).find(".input-saldoinicial").val(),c=$(o).find(".input-ratio").val(),d=$(o).find(".input-importefijo").val();"02"==r?a=c:"03"==r&&(a=d);var l=new DetallePropiedad(i,n,a);t.push(l)}),o=JSON.stringify(t),e.append("btnSaveValuesPropiedades","btnSaveValuesPropiedades"),e.append("hdTipoValoracion",r),e.append("detallePropiedad",o),$.ajax({url:"services/propiedad/propiedad-post.php",type:"POST",cache:!1,dataType:"json",contentType:!1,processData:!1,data:e,success:function(e){precargaExp("#pnlListPropiedades",!1),MessageBox(e.titulomsje,e.contenidomsje,"[Aceptar]",function(){"0"!=e.rpta&&(closeCustomModal("#modalGenValorFijo"),$("#btnClearSelPropiedades").trigger("click"),paginaPropiedad=1,ListarPropiedades("1"))})},error:function(e){console.log(e)}})}$(function(){ListarProyectos("1"),ListarAnhoProceso(),fakewaffle.responsiveTabs(["xs","sm"]),$("#myTab").on("click","a",function(e){e.preventDefault(),$(this).tab("show");var o=this.getAttribute("href");o=o.substr(1),"propiedades"!=o&&createFrame("#pnlInfoGeneralProyecto",this)}),$("#tabProyecto").on("click","a",function(e){e.preventDefault(),$(this).tab("show"),createFrame("#pnlInfoDetalleProyecto",this)}),$("#gvDatos").on("click",".dropdown a",function(e){e.preventDefault();var o=this.getAttribute("data-action"),a=getParentsUntil(this,"#gvDatos",".dato"),t=a[0].getAttribute("data-idproyecto");"more-info"==o&&($("#hdIdProyecto").val(t),$("#pnlInfoGeneralProyecto iframe").remove(),$("#pnlInfoDetalleProyecto iframe").remove(),$("#pnlListado").fadeOut(400,function(){$("#pnlOpciones").fadeIn(400,function(){GoToPropiedades(proyecto),$("#myTabs li.active").removeClass("active"),$("#pnlInfoGeneralProyecto .tab-pane.active").removeClass("active"),$("#myTabs li:first-child").addClass("active"),$("#pnlInfoGeneralProyecto .tab-pane:first").addClass("active"),$("#tabProyecto li.active").removeClass("active"),$("#pnlInfoDetalleProyecto .tab-pane.active").removeClass("active"),$("#tabProyecto li:first-child").addClass("active"),$("#pnlInfoDetalleProyecto .tab-pane:first").addClass("active")})}))}),$("#txtFechaVencimiento").mask("99/99/9999"),cargarDatePicker("#txtFechaVencimiento",function(e,o){}),$("#txtFechaTope").mask("99/99/9999"),cargarDatePicker("#txtFechaTope",function(e,o){}),$("#btnIniciarFacturacion").on("click",function(e){e.preventDefault(),openCustomModal("#modalGenFacturacion")}),$("#btnGenerarFacturacion").on("click",function(e){e.preventDefault(),GenerarFacturacion()}),$("#btnNuevo, #btnEditar").on("click",function(e){e.preventDefault(),$("#tableConcepto tbody").html(""),$("#tableConceptoFormula tbody").html(""),LimpiarProyecto(),cancelImport(),setUbigeo(0,"Localidad"),"btnNuevo"==this.getAttribute("id")&&$("#hdIdProyecto").val("0"),GoToEdit()}),$(".btnBackList").on("click",function(e){e.preventDefault(),BackToPrevPanel(),$("#hdIdProyecto").val("0"),"btnBackToProyecto"==$(this).attr("id")&&($("#btnLimpiarSeleccion").trigger("click"),$("#btnClearSelPropiedades").trigger("click"))}),$("#btnCancelar").on("click",function(e){e.preventDefault(),closeCustomModal("#modalRegistroProyecto")}),$("#btnProceso").on("click",function(e){e.preventDefault(),openModalCallBack("#modalProceso",function(){ListarProcesos()})}),$("#gvUbigeo").on("click",".panel-info",function(e){e.preventDefault();var o="0",a="";o=$(this).attr("data-idubigeo"),a=$(this).find(".descripcion").text(),setUbigeo(o,a)}),$("#txtSearchUbigeo").on("keyup",function(e){ListarUbigeo()}),$("#pnlInfoUbigeo").on("click",function(e){e.preventDefault(),openModalCallBack("#modalUbigeo",function(){precargaExp("#modalUbigeo",!0),ListarUbicacion("#ddlDepartamento","1","0",function(){ListarUbicacion("#ddlProvincia",$("#ddlDepartamento").val(),"0",function(){ListarUbicacion("#ddlDistrito",$("#ddlProvincia").val(),"0",function(){precargaExp("#modalUbigeo",!1)})})})})}),$("#ddlDepartamento").on("change",function(e){e.preventDefault(),precargaExp("#modalUbigeo",!0),ListarUbicacion("#ddlProvincia",$(this).val(),"0",function(){ListarUbicacion("#ddlDistrito",$("#ddlProvincia").val(),"0",function(){precargaExp("#modalUbigeo",!1)})})}),$("#ddlProvincia").on("change",function(e){e.preventDefault(),precargaExp("#modalUbigeo",!0),ListarUbicacion("#ddlDistrito",$(this).val(),"0",function(){precargaExp("#modalUbigeo",!1)})}),$("#btnAplicarUbigeo").on("click",function(e){e.preventDefault();var o="0",a="";o=$("#ddlDistrito").val(),a="Perú/"+$("#ddlDepartamento option:selected").text()+"/"+$("#ddlProvincia option:selected").text()+"/"+$("#ddlDistrito option:selected").text(),setUbigeo(o,a)}),$("#btnHideConstructora").on("click",function(e){e.preventDefault(),$("#pnlConstructora").fadeOut(400,function(){})}),$("#pnlInfoConstructora").on("click",function(e){e.preventDefault(),ShowPanelConstructora()}),$("#gvConstructora .items-area").on("click",".tile",function(e){e.preventDefault();var o="0",a="";o=$(this).attr("data-idconstructora"),a=$(this).attr("data-nombre"),setConstructora(o,a)}),$("#ddlTipoProyecto").on("change",function(e){e.preventDefault(),ShowAskCobroTorre()}),$("#ddlTipoValoracion").on("change",function(e){e.preventDefault()}),$("#chkDatoSimpleDuplex").on("click",function(e){MostrarRowPorcentajeDuplex(this.checked)}),$("#chkPorcjDuplex").on("click",function(e){MostrarPorcjDuplex(this.checked)}),$("#ddlBanco").on("change",function(e){e.preventDefault(),ListarCuentaBancaria("0")}),$("#btnGuardar").on("click",function(e){GuardarDatos()}),$("#btnListPropiedades").on("click",function(e){e.preventDefault(),GoToPropiedades()}),$("#btnGenPropFromList").on("click",function(e){e.preventDefault();var o;LimpiarForm(),$("#rowTipoPropiedad").show(),$("#rowRangos").show(),o=$("#gvDatos .list.selected"),tipoproyecto=o.attr("data-tipoproyecto"),GetLastIndexPropiedad(),openModalCallBack("#modalGenPropiedad",function(){})}),$("#btnMassConcept").on("click",function(e){e.preventDefault(),LimpiarForm(),GoToEditPropiedad()}),$("#form1").validate({lang:"es",showErrors:showErrorsInValidate,submitHandler:EnvioAdminDatos}),$("#chkIngresoTorre").on("click",function(e){$(this)[0].checked?($("#pnlInfoTorre").addClass("oculto"),$("#rowIngreso").removeClass("oculto"),$("#txtIngresoTorre").focus()):($("#pnlInfoTorre").removeClass("oculto"),$("#rowIngreso").addClass("oculto"))}),$("#pnlInfoTorre").on("click",function(e){e.preventDefault(),openModalCallBack("#modalTorre",function(){ListarTorres()})}),$("#btnLimpiarSeleccion").on("click",function(e){e.preventDefault(),$("#hdIdProyecto").val("0"),$("#gvDatos .dato.selected").removeClass("selected"),$("#gvDatos input:checkbox:checked").removeAttr("checked"),$("#btnNuevo, #btnUploadExcel").removeClass("oculto"),$("#btnLimpiarSeleccion, #btnListPropiedades, #btnEditar, #btnFijarProyecto, #btnEliminar, #btnIniciarFacturacion").addClass("oculto")}),$("#gvPropiedad").on("click",'.tile[data-relaciones!="0"] .link-relacion',function(e){e.preventDefault();var o="0";return o=$(this).parent().parent().parent().parent().attr("data-idpropiedad"),ShowPanelRelacionadas(o),!1}),$("#gvPropiedad").on("click",".tile",function(e){e.preventDefault();var o=$(this).find("input:checkbox"),a=$("#ddlTipoPropiedadFiltro").val(),t=$("#hdTipoValoracion").val(),r=$(this).find(".inputInItem"),i=$(this).find(".input-saldoinicial"),n=$(this).find(".inputRatio"),c=$(this).find(".inputImporteFijo");$(this).hasClass("selected")?($(this).removeClass("selected"),o.removeAttr("checked"),r.addClass("hide"),n.addClass("hide"),c.addClass("hide"),0==$("#gvPropiedad .dato.selected").length?($("#btnGenPropFromList").removeClass("oculto"),$("#btnAsignPropToPerson, #btnMassConcept, #btnEliminarPropiedad, #btnClearSelPropiedades, #btnRelacionarPropiedades, #btnRomperRelaciones").addClass("oculto")):1==$("#gvPropiedad .dato.selected").length&&("EST"==a||"DEP"==a?$("#btnRelacionarPropiedades, #btnRomperRelaciones").removeClass("oculto"):$("#btnRelacionarPropiedades, #btnRomperRelaciones").addClass("oculto"),$("#btnAsignPropToPerson, #btnMassConcept, #btnEliminarPropiedad, #btnClearSelPropiedades").removeClass("oculto"))):($(this).addClass("selected"),o.attr("checked",""),r.removeClass("hide"),"02"==t?n.removeClass("hide"):"03"==t&&c.removeClass("hide"),i.focus(),$("#btnGenPropFromList").addClass("oculto"),"EST"==a||"DEP"==a?$("#btnRelacionarPropiedades, #btnRomperRelaciones").removeClass("oculto"):$("#btnRelacionarPropiedades, #btnRomperRelaciones").addClass("oculto"),$("#btnAsignPropToPerson, #btnMassConcept, #btnEliminarPropiedad, #btnClearSelPropiedades").removeClass("oculto"))}),$("#gvPropiedad").on("focus","input:text",function(e){$(this).select()}),$("#gvPropiedad").on("click","input:text",function(e){e.preventDefault(),e.stopPropagation()}),$("#gvDepartamento").on("click",".tile",function(e){e.preventDefault();var o=$(this).find("input:checkbox");$(this).hasClass("selected")?($(this).removeClass("selected"),o.removeAttr("checked"),0==$("#gvDepartamento .dato.selected").length?$("#btnRelacionar, #btnClearSelDepartamentos").addClass("oculto"):$("#btnRelacionar, #btnClearSelDepartamentos").removeClass("oculto")):($(this).siblings(".selected").removeClass("selected"),$(this).addClass("selected"),o.attr("checked",""),$("#btnRelacionar, #btnClearSelDepartamentos").removeClass("oculto"))}),$("#btnClearSelDepartamentos").on("click",function(e){e.preventDefault(),$("#btnSelectAllDepartamentos").removeClass("oculto"),$("#gvDepartamento .tile.selected").removeClass("selected"),$("#gvDepartamento input:checkbox:checked").removeAttr("checked"),$("#btnRelacionar, #btnClearSelDepartamentos").addClass("oculto")}),$("#btnSelectAllDepartamentos").on("click",function(e){e.preventDefault(),$(this).addClass("oculto"),$("#gvDepartamento .tile").addClass("selected"),$("#gvDepartamento input:checkbox").attr("checked",""),$("#btnRelacionar, #btnClearSelDepartamentos").removeClass("oculto")}),$("#btnRelacionarPropiedades").on("click",function(e){e.preventDefault(),ShowPanelDepartamento()}),$("#btnRelacionar").on("click",function(e){e.preventDefault(),RelacionarDepartamento()}),$("#btnRomperRelaciones").on("click",function(e){e.preventDefault(),RomperRelaciones()}),$("#btnHideDepartamento").on("click",function(e){e.preventDefault(),$("#pnlDepartamento").fadeOut(400,function(){$("#btnClearSelDepartamentos").trigger("click")})}),$("#btnHideRelaciones").on("click",function(e){e.preventDefault(),$("#pnlRelacionadas").fadeOut(400,function(){})}),$("#btnClearSelPropiedades").on("click",function(e){e.preventDefault(),$("#btnSelectAllPropiedades").removeClass("oculto"),$("#gvPropiedad .tile.selected").removeClass("selected"),$("#gvPropiedad input:checkbox:checked").removeAttr("checked"),$("#btnGenPropFromList").removeClass("oculto"),$("#gvPropiedad .inputInItem").addClass("hide"),$("#btnAsignPropToPerson, #btnMassConcept, #btnEliminarPropiedad, #btnClearSelPropiedades, #btnRelacionarPropiedades, #btnRomperRelaciones").addClass("oculto")}),$("#btnSelectAllPropiedades").on("click",function(e){e.preventDefault(),$(this).addClass("oculto"),$("#gvPropiedad .tile").addClass("selected"),$("#gvPropiedad input:checkbox").attr("checked",""),$("#btnGenPropFromList").addClass("oculto"),$("#gvPropiedad .inputInItem").removeClass("hide"),$("#btnAsignPropToPerson, #btnMassConcept, #btnEliminarPropiedad, #btnClearSelPropiedades").removeClass("oculto")}),$("#btnSaveValuesPropiedades").on("click",function(e){e.preventDefault(),openModalCallBack("#modalGenValorFijo",function(){var e=!1,o=!1,a=$("#hdTipoValoracion").val(),t=$("#optOtroValor").parent().find(".text");$("#txtValorFijo").val("0.00"),$("#gvPropiedad .dato.selected").length>0?e=!0:($("#optAllValue")[0].checked=!0,$("#optSaldoInicial")[0].checked=!0,$("#txtValorFijo").focus()),$("#optDirect")[0].checked=e,habilitarControl("#optDirect",e),"02"==a||"03"==a?(o=!0,"02"==a?t.text("Ratio fijo"):t.text("Importe fijo")):t.text("No disponible"),habilitarControl("#optOtroValor",o)})}),$("#btnGuardarValores").on("click",function(e){e.preventDefault(),$("#optDirect")[0].checked?ActualizarValorPropiedad():ActualizarValorFijoMasivo()}),$("#btnAsignPropToPerson").on("click",function(e){e.preventDefault(),ShowPanelPropietarioInquilino()}),$("#pnlInfoArea").on("click",function(e){e.preventDefault(),unsetArea(),$("#gpConcepto").removeClass("gp-no-body").removeClass("gp-expand-header"),openCustomModal("#modalConcepto")}),$("#btnHidePropietarioInquilino").on("click",function(e){e.preventDefault(),$("#pnlPropietarioInquilino").fadeOut(400,function(){$("#btnClearSelPropInquilino").trigger("click")})}),$("#txtAreaTechada").on({keydown:function(e){if(e.keyCode==$.ui.keyCode.ENTER)return $("#txtAreaSinTechar").focus(),!1},keypress:function(e){if(e.keyCode==$.ui.keyCode.ENTER)return!1},keyup:function(e){CalcularArea()}}),$("#txtAreaSinTechar").on("keyup",function(e){CalcularArea()}),$("#pnlPropietarioInquilino").on("click",".list",function(e){e.preventDefault();var o=$(this).find("input:checkbox");$(this).hasClass("selected")?($(this).removeClass("selected"),o.removeAttr("checked"),0==$("#pnlPropietarioInquilino .dato.selected").length?$("#btnClearSelPropInquilino, #btnAsignarPropiedades").addClass("oculto"):1==$("#pnlPropietarioInquilino .dato.selected").length&&$("#btnClearSelPropInquilino, #btnAsignarPropiedades").removeClass("oculto")):($(this).addClass("selected"),o.attr("checked",""),$("#btnClearSelPropInquilino, #btnAsignarPropiedades").removeClass("oculto"))}),$("#btnClearSelPropInquilino").on("click",function(e){e.preventDefault(),$("#btnSelectAllPropInquilino").removeClass("oculto"),$("#pnlPropietarioInquilino .dato.selected").removeClass("selected"),$("#pnlPropietarioInquilino input:checkbox:checked").removeAttr("checked"),$("#btnClearSelPropInquilino, #btnAsignarPropiedades").addClass("oculto")}),$("#btnSelectAllPropInquilino").on("click",function(e){e.preventDefault(),$(this).addClass("oculto"),$("#pnlPropietarioInquilino .dato").addClass("selected"),$("#pnlPropietarioInquilino input:checkbox").attr("checked",""),$("#btnClearSelPropInquilino, #btnAsignarPropiedades").removeClass("oculto")}),$("#btnAsignarPropiedades").on("click",function(e){e.preventDefault(),AsignarPropiedades()}),$("#txtSearch").keydown(function(e){if(e.keyCode==$.ui.keyCode.ENTER)return $("#btnSearch").trigger("click"),!1}).keypress(function(e){if(e.keyCode==$.ui.keyCode.ENTER)return!1}),$("#btnSearch").on("click",function(e){e.preventDefault(),$("#btnLimpiarSeleccion").trigger("click"),paginaProyecto=1,ListarProyectos("1")}),$("#txtSearchPropiedad").keydown(function(e){if(e.keyCode==$.ui.keyCode.ENTER)return $("#btnSearchPropiedad").trigger("click"),!1}).keypress(function(e){if(e.keyCode==$.ui.keyCode.ENTER)return!1}),$("#btnSearchPropiedad").on("click",function(e){e.preventDefault(),$("#btnClearSelPropiedades").trigger("click"),paginaPropiedad=1,ListarPropiedades("1")}),$("#txtSearchPropietario").keydown(function(e){if(e.keyCode==$.ui.keyCode.ENTER)return $("#btnSearchPropietario").trigger("click"),!1}).keypress(function(e){if(e.keyCode==$.ui.keyCode.ENTER)return!1}),$("#btnSearchPropietario").on("click",function(e){e.preventDefault(),paginaPropietario=1,ListarPropietarios("1")}),$("#txtSearchInquilino").keydown(function(e){if(e.keyCode==$.ui.keyCode.ENTER)return $("#btnSearchInquilino").trigger("click"),!1}).keypress(function(e){if(e.keyCode==$.ui.keyCode.ENTER)return!1}),$("#btnSearchInquilino").on("click",function(e){e.preventDefault(),paginaInquilino=1,ListarInquilinos("1")}),$("#gvDatos").on("scroll",function(){var e=0;$(this).scrollTop()+$(this).innerHeight()>=$(this)[0].scrollHeight&&(e=Number($("#hdPagePropiedad").val()),ListarProyectos(e))}),$("#gvPropiedad > .items-area").on("scroll",function(){var e=0;$(this).scrollTop()+$(this).innerHeight()>=$(this)[0].scrollHeight&&(e=Number($("#hdPagePropiedad").val()),ListarPropiedades(e))}),$("#gvPropietario > .items-area").on("scroll",function(){var e=0;$(this).scrollTop()+$(this).innerHeight()>=$(this)[0].scrollHeight&&(e=Number($("#hdPagePropietario").val()),ListarPropietarios(e))}),$("#gvInquilino > .items-area").on("scroll",function(){var e=0;$(this).scrollTop()+$(this).innerHeight()>=$(this)[0].scrollHeight&&(e=Number($("#hdPageInquilino").val()),ListarInquilinos(e))}),$("#ddlTipoPropiedadFiltro").on("change",function(e){e.preventDefault(),$("#btnClearSelPropiedades").trigger("click"),paginaPropiedad=1,ListarPropiedades("1")}),$("#ddlTipoPropiedad").on("change",function(e){e.preventDefault(),GetLastIndexPropiedad()}),$("#tableConcepto tbody").on("keyup","input:text",function(e){EvalConcepto()}),$("#btnAplicarConcepto").on("click",function(e){e.preventDefault(),setArea(),closeCustomModal("#modalConcepto")}),$("#btnPropiedadMasiva").on("click",function(e){e.preventDefault(),EditMassrPropiedad()});var e=[];$(document).ajaxSend(function(o,a,t){e.push(a)}),$(document).ajaxComplete(function(o,a,t){e=$.grep(e,function(e){return e!=a})});var o=function(){completado=!0,$.each(e,function(e,o){o.abort()})};$("#btnCancelarGenProp").add("#btnCloseModalGenPropiedad").on("click",function(e){e.preventDefault(),0==completado&&(confirma=confirm("¿Está seguro de cancelar el envío?"),confirma&&(progress=0,indexList=0,intervalProgress.isRunning()&&intervalProgress.stop(),o(),MessageBox("Operaci&oacute;n cancelada","Se cancelaron todas las peticiones","[Aceptar]",function(){}))),closeCustomModal("#modalGenPropiedad")}),$("#btnEliminarPropiedad").on("click",function(e){e.preventDefault(),confirma=confirm("¿Desea eliminar los elementos seleccionados?"),confirma&&EliminarPropiedad()}),$("#btnGenVistaPropiedad").on("click",function(e){e.preventDefault(),GenerarVistaPreviaPropiedad()}),$("#pnlInfoConcepto").on("click",function(e){e.preventDefault(),$("#gpConcepto").addClass("gp-no-body").addClass("gp-expand-header"),openCustomModal("#modalConcepto")}),$("#btnBackToInfoProyecto").on("click",function(e){e.preventDefault(),$("#pnlInfoDetalleProyecto").fadeOut(400,function(){$("#pnlInfoGeneralProyecto").fadeIn(400,function(){})})}),$("#tableProceso tbody").on("click","tr button",function(e){e.preventDefault();var o=this.parentNode.parentNode;return $("#pnlInfoDetalleProyecto iframe").remove(),$("#tabProyecto a").eq(0).trigger("click"),$("#pnlInfoGeneralProyecto").fadeOut(400,function(){$("#pnlInfoDetalleProyecto").fadeIn(400,function(){})}),closeCustomModal("#modalProceso"),$("#lblProceso").attr({"data-mes":o.getAttribute("data-mes"),"data-anho":o.getAttribute("data-anho")}).text($(o).find("td:eq(1) h4").text()+" "+o.getAttribute("data-anho")),!1}),$("#tableProceso tbody").on("click",'tr[data-estado="1"]',function(e){e.preventDefault(),$(this).siblings(".selected").removeClass("selected"),$(this).addClass("selected"),$("#btnCerrarProceso").removeClass("oculto")}),$("#btnAbrirProceso").on("click",function(e){e.preventDefault(),GestionarProceso(!0)}),$("#btnCerrarProceso").on("click",function(e){e.preventDefault(),GestionarProceso(!1)}),$("#btnFijarProyecto").on("click",function(e){e.preventDefault(),FijarProyecto()}),$(".droping-air").on({dragenter:function(e){e.stopPropagation(),e.preventDefault()},dragover:function(e){e.stopPropagation(),e.preventDefault()},change:function(e){e.preventDefault(),prepareImport(this.files)},drop:function(e){e.preventDefault();var o=e.originalEvent.dataTransfer.files;prepareImport(o)}},".file-import"),$(".droping-air .cancel").on("click",function(e){e.preventDefault(),cancelImport()}),$("#btnEliminar").on("click",function(e){e.preventDefault(),confirma=confirm("¿Desea eliminar los elementos seleccionados?"),confirma&&EliminarProyecto()})});var indexList=0,elemsSelected,progress=0,progressError=!1,paginaProyecto=1,paginaPropiedad=1,paginaPropietario=1,paginaInquilino=1,formula="",fileValue=!1,completado=!0,arrMeses=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],intervalProgress=new Interval(function(){
var e,o;o=$(elemsSelected[indexList]).find(".progress-bar"),e=o.progressbar({animate:!0,color:"bg-cyan"}),e.progressbar("value",++progress),100==progress&&intervalProgress.stop()},100);