function initUploader(){var e=$("#upload ul"),t=getParameterByName("folder"),i=getParameterByName("tipo");$("#upload").fileupload({formData:{folder:t,tipo:i},dropZone:$("#drop"),add:function(t,n){var a=n.files[0],o="media"==i?/\.(gif|jpg|jpeg|tiff|png)$/i.test(a.name):/\.(pdf|doc|docx|xls|xlsx|ppt|pptx|zip|rar|7z|rtf|html|htm)$/i.test(a.name),r=!0;if(o||(alert("Tipo de archivo no permitido"),r=!1),r){var d=$('<li class="working"><input type="text" value="0" data-width="48" data-height="48" data-fgColor="#0788a5" data-readOnly="1" data-bgColor="#3e4043" /><p></p><span></span></li>');d.find("p").text(n.files[0].name).append("<i>"+formatFileSize(n.files[0].size)+"</i>"),n.context=d.appendTo(e),d.find("input").knob(),d.find("span").click(function(){d.hasClass("working")&&p.abort(),d.fadeOut(function(){d.remove()})}),numberFiles+=1;var p=n.submit()}},progress:function(e,t){var i=parseInt(t.loaded/t.total*100,10);t.context.find("input").val(i).change(),100==i&&t.context.removeClass("working")},fail:function(e,t){t.context.addClass("error")},done:function(e,n){numberFiles-=1,0==numberFiles&&window.parent.ListarArchivos(t,i)}})}function formatFileSize(e){return"number"!=typeof e?"":e>=1e9?(e/1e9).toFixed(2)+" GB":e>=1e6?(e/1e6).toFixed(2)+" MB":(e/1e3).toFixed(2)+" KB"}$(function(){initUploader(),$("#drop a").click(function(){$(this).parent().find("input").click()}),$(document).on("drop dragover",function(e){e.preventDefault()})});var numberFiles=0;